# 线程安全问题

## 一、什么时候考虑安全问题？

### 1.1 需要考虑线程安全问题的情况

- **条件1**：多线程的并发环境下。
- **条件2**：有共享的数据。
- **条件3**：共享数据涉及到修改的操作。

### 1.2 一般情况下的线程安全性分析

- **局部变量**：一般情况下局部变量不存在线程安全问题。特别是**基本数据类型**的局部变量，因为它们在栈中存储，栈是线程私有的，不是共享的。如果是**引用数据类型**的局部变量，就另当别论了，因为它们可能指向堆中的共享对象。

- **实例变量**：可能存在线程安全问题。实例变量存储在堆中，堆是多线程共享的。因此，如果多个线程同时访问和修改实例变量，可能会引起数据不一致。

- **静态变量**：也可能存在线程安全问题。静态变量在堆中存储，多个线程可能会同时访问和修改静态变量，从而引发安全问题。


### 1.3 解决多线程并发操作中的安全问题

为了解决多线程并发操作中的安全问题，可以使用线程同步机制，即让线程t1和线程t2排队执行，保证同一时间只有一个线程能够对共享数据进行修改。

- **线程同步机制**：t1线程在执行的时候必须等待t2线程执行到某个位置之后，t1线程才能执行。只要t1和t2之间发生了等待，就认为是同步。这种机制虽然效率低，但是可以保证数据的安全性。

- **线程异步机制**：t1和t2各自独立执行，不需要等待对方。这种机制效率高，但是可能存在安全隐患，因为并发执行时可能会导致数据不一致。
